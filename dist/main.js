(()=>{"use strict";class e{constructor(e,t,s){this._cardTemplateSelector=t,this._cardName=e.name,this._cardLink=e.link,this._handleCardClick=s,this._data=e}getCardElement(){return this._cardElement=this._getCardTemplate(),this._cardElementImage=this._cardElement.querySelector(".element__image"),this._cardElementImage.src=this._cardLink,this._cardElementImage.alt=this._cardName,this._cardElement.querySelector(".element__text").textContent=this._cardName,this._setEventListeners(this._cardElement,this._cardElementImage),this._cardElement}_getCardTemplate(){return document.querySelector(this._cardTemplateSelector).content.cloneNode(!0)}_setEventListeners(e,t){e.querySelector(".element__trash").addEventListener("click",(e=>{this._deleteCard(e.target)})),e.querySelector(".element__reaction").addEventListener("click",(e=>{this._toggleLike(e.target)})),t.addEventListener("click",(()=>{this._handleCardClick(t)}))}_toggleLike(e){e.classList.toggle("element__reaction_like")}_deleteCard(e){e.closest(".element").remove()}}class t{constructor(e,t){this._form=t,this._submitButton=this._form.querySelector(e.submitButtonSelector),this._inputList=Array.from(this._form.querySelectorAll(e.inputSelector)),this._inputSelector=e.inputSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._errorClassTemplate=e.errorClassTemplate,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass}enableValidation(){this._toggleButtonState(),this._setEventListeners()}hideErrorMessagesAndCheckButtonState(){this._toggleButtonState(),this._inputList.forEach((e=>{const t=this._form.querySelector(`.${e.name}${this._errorClassTemplate}`);this._hideInputError(e,t)}))}_setEventListeners(){this._inputList.forEach((e=>{e.classList.add(this._inputEventListenerAddedClass),e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}_checkInputValidity(e){const t=this._form.querySelector(`.${e.name}${this._errorClassTemplate}`);e.validity.valid?this._hideInputError(e,t):this._showInputError(e,t)}_showInputError(e,t){e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e,t){e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_toggleButtonState(){this._hasInvalidInput()?this._disableSubmitButton():this._enableSubmitButton()}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}_disableSubmitButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.setAttribute("disabled","true")}_enableSubmitButton(e){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.removeAttribute("disabled","true")}}class s{constructor({items:e,renderer:t},s){this._renderedItems=e,this._renderer=t,this._container=document.querySelector(s)}renderItems(){this._renderedItems.forEach((e=>this._renderer(e)))}addItem(e){this._container.prepend(e)}}class r{constructor(e){this._popup=document.querySelector(e)}open(){this._popup.classList.add("popup_opened")}close(){this._popup.classList.remove("popup_opened")}setEventListeners(){document.addEventListener("click",this._checkClickTarget),document.addEventListener("keydown",this._handleEscClose.bind(this)),this._popup.querySelector(".popup__close-button").addEventListener("click",this.close.bind(this))}_handleEscClose(e){"Escape"===e.key&&this.close()}_checkClickTarget=e=>{if(e.target.closest(".popup_opened")){const t=e.target.closest(".popup__container");this._closeTargetPopup(t)}};_closeTargetPopup=e=>{null===e&&this.close()}}class i extends r{constructor(e,t){super(e),this._handleSubmitForm=t,this._popupForm=this._popup.querySelector(".popup__form")}close(){super.close(),this._popupForm.reset()}_getInputValues(){return this._inputList=this._popup.querySelectorAll(".popup__input"),this._formValues={},this._inputList.forEach((e=>this._formValues[e.name]=e.value)),this._formValues}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._data=this._getInputValues(),this._handleSubmitForm(this._data)}))}}const n=document.querySelector(".profile__editbutton"),o=document.querySelector(".card-creator__input"),a=document.querySelector(".profile-form__input"),l=document.querySelector(".profile-form__name"),c=document.querySelector(".profile-form__career"),_=document.querySelector(".profile__addbutton"),u={formSelector:".popup__form",inputSelector:".popup__input",errorClassTemplate:"-error",inputErrorClass:"popup__input_type_error",errorClass:"popup__input-error_active",submitButtonSelector:".popup__save-button",inactiveButtonClass:"popup__save-button_disabled"},p=new t(u,o);p.enableValidation();const d=new t(u,a);d.enableValidation(),n.addEventListener("click",(()=>{const e=E.getUserInfo();l.value=e.name,c.value=e.career,C.open(),d.hideErrorMessagesAndCheckButtonState()})),_.addEventListener("click",(()=>{g.open(),p.hideErrorMessagesAndCheckButtonState()}));const h=t=>new s({items:t,renderer(t){const s=new e(t,".cardTemplate",m).getCardElement();S.addItem(s)}},".elements"),m=e=>{v.open(e)},g=new i(".card-creator",(e=>{const t={};t.link=e.cardLink,t.name=e.cardName,h([t]).renderItems(),g.close()}));g.setEventListeners();const C=new i(".profile-form",(e=>{E.setUserInfo(e),C.close()}));C.setEventListeners();const E=new class{constructor({userNameSelector:e,userCareerSelector:t}){this._userName=document.querySelector(e),this._userCareer=document.querySelector(t),this._userData={}}getUserInfo(){return this._userData.name=this._userName.textContent,this._userData.career=this._userCareer.textContent,this._userData}setUserInfo(e){this._userName.textContent=e.profileName,this._userCareer.textContent=e.profileCareer}}({userNameSelector:".profile__username",userCareerSelector:".profile__aboutuser"}),v=new class extends r{constructor(e){super(e)}open(e){super.open();const t=this._popup.querySelector(".popup__image");t.src=e.src,t.alt=`На фото: ${e.alt}`,this._popup.querySelector(".popup__figcaption").textContent=e.alt}}(".popup_picture_opened");v.setEventListeners();const S=h([{name:"Волга",link:"src/images/element__volga_fedor-shlyapnikov.jpg"},{name:"Карелия",link:"src/images/element__karelia_egor-myznik.jpg"},{name:"Байкал",link:"src/images/element__baykal_kir-simakov.jpg"},{name:"Домбай",link:"src/images/element__dombay_kirill-pershin.png"},{name:"Гора Эльбрус",link:"src/images/element__elbrus_kirill-pershin.png"},{name:"Карачаево-Черкессия",link:"src/images/element__karachaevsk_kirill-pershin.jpg"}]);S.renderItems()})();